### ğŸ”¹ ç¬¬ 1 å±‚ï¼šé€šç”¨ä¸»è¡¨ `cloud_resource`
```
class CloudResource(Base):
    __tablename__ = "cloud_resource"

    id = Column(String, primary_key=True)  # å¯ä»¥ç”¨ hash(account_id + type + resource_id)
    cloud_account_id = Column(String, nullable=False)
    provider = Column(String, nullable=False)
    region = Column(String)
    zone = Column(String)
    resource_type = Column(String, nullable=False)
    resource_id = Column(String, nullable=False)
    name = Column(String)
    status = Column(String)
    domain_name = Column(String)
    vpc_id = Column(String)
    ip_addresses = Column(Text)  # JSON string: ["1.2.3.4"]
    tags = Column(Text)          # JSON string: {"env": "prod", "app": "web"}
    resource_metadata = Column(Text)  # Full structure
    fetched_at = Column(DateTime, nullable=False)

    __table_args__ = (
        UniqueConstraint("cloud_account_id", "resource_type", "resource_id", name="uniq_resource"),
    )
```
#### âœ… ä¸€ã€ç»Ÿä¸€è¡¨è®¾è®¡çš„ä¼˜åŠ¿ï¼ˆcloud_resourceï¼‰
 1ï¸âƒ£ ç»Ÿä¸€æŸ¥è¯¢æ¥å£ï¼ˆå¯¹äºº & å¯¹ä»£ç ï¼‰ç®€å•
ä½ åªè¦ queryï¼š
`SELECT * FROM cloud_resource WHERE resource_type = 'ecs';`

è€Œä¸éœ€è¦ï¼š
`SELECT * FROM ecs_table; -- AWS SELECT * FROM aliyun_ecs_table; -- é˜¿é‡Œäº‘`

å¯¹äºä½ å·²æœ‰çš„æ’ä»¶æ¶æ„ï¼ˆ`collectors/aws/`, `collectors/aliyun/`ï¼‰ï¼Œç»Ÿä¸€è¡¨å¤§å¤§ç®€åŒ–æ•°æ®å†™å…¥å’Œåç»­åˆ†æã€‚

2ï¸âƒ£ æ˜“äºç»Ÿä¸€å­˜å‚¨ä¸å¯¼å‡º
- è‹¥ä½ è¦å¯¼å‡ºå…¨éƒ¨èµ„æºæ¸…å•ä¸€ä»½ CSVã€Excelã€ä¾›è´¢åŠ¡/è¿è¥/å®¡è®¡éƒ¨é—¨ç”¨
- ä¸éœ€åˆå¹¶å¤šä¸ªè¡¨
- å¯¹ ClickHouse ç­‰åˆ†æå‹ç³»ç»Ÿå¯ç›´æ¥ `INSERT SELECT * FROM cloud_resource`

3ï¸âƒ£ æ›´å®¹æ˜“åš diff ä¸å…³ç³»æ˜ å°„ï¼ˆè·¨èµ„æºç±»å‹ï¼‰
ä½ è¦æ¯”è¾ƒæŸå¤©çš„èµ„æºå˜åŒ–æ—¶ï¼Œåªéœ€ï¼š
`SELECT * FROM cloud_resource WHERE fetched_at BETWEEN A AND B;`
### 4ï¸âƒ£ å¤šäº‘å¹³å°æ›´é€‚é…

ä½ çš„åœºæ™¯æ˜¯ã€Œé˜¿é‡Œäº‘ + AWS + Cloudflare + ...ã€

- è‹¥æ¯ä¸ªå¹³å°åˆ†è¡¨ï¼Œæ¯ä¸ªå¹³å°ä¸‹èµ„æºç±»å‹åˆä¸åŒï¼Œçˆ†ç‚¸å¼å¢é•¿
    
- ä¾‹å¦‚ï¼š`aws_ec2`ã€`aws_eip`ã€`aliyun_slb`ã€`cloudflare_zone`...
    
- æœªæ¥æ¥å…¥è…¾è®¯äº‘ã€åä¸ºäº‘ã€Oracle Cloud ä½ å°±ä¼šå´©æºƒ
    

ç»Ÿä¸€è¡¨ + `provider` + `resource_type` å°±èƒ½æ¸…æ™°è¡¨è¾¾æ‰€æœ‰å†…å®¹ã€‚
è‹¥åˆ†è¡¨ï¼Œè¦åˆå¹¶å¤šä¸ªè¡¨ã€ç»Ÿä¸€å­—æ®µå¯¹æ¯”ï¼Œæˆæœ¬å¾ˆé«˜ã€‚
### ğŸ”¹ ç¬¬ 2 å±‚ï¼šå…¨é‡ç»“æ„æ•°æ®ï¼ˆå·²åœ¨ä¸Šè¡¨ä¸­çš„ `resource_metadata`ï¼‰
ä¸ç”¨é¢å¤–è¡¨ï¼Œ`resource_metadata` å­—æ®µå·²ä¿ç•™å…¨é‡ç»“æ„åŒ–å†…å®¹ï¼ŒJSON å­˜å‚¨ã€‚

### ğŸ”¹ ç¬¬ 3 å±‚ï¼šèµ„æºä¾èµ–å›¾ `resource_relationship`

```
class ResourceRelationship(Base):
    __tablename__ = "resource_relationship"

    id = Column(Integer, primary_key=True, autoincrement=True)
    source_id = Column(String, nullable=False)       # cloud_resource.id
    target_id = Column(String, nullable=False)       # cloud_resource.id
    relation_type = Column(String, nullable=False)   # e.g., "attached_to", "points_to"

    __table_args__ = (
        Index("idx_relation_src", "source_id"),
        Index("idx_relation_tgt", "target_id"),
    )

```